<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="b4271a55-e0a5-43fd-ab5a-4ee169bb7b4d" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="GlobalRedemptionTransaction" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="b4271a55-e0a5-43fd-ab5a-4ee169bb7b4dfileName">GlobalRedemptionTransaction</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="datasource" name="ProgramOffersGlobalLimit" id="8d88c5c1-6f70-4730-9209-c5833dba2006">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="File">
        <con:configuration>
          <fileName>${#Project#ProjectPath}/References/ProgramOffersGlobalLimit.csv</fileName>
          <separator>,</separator>
          <trim>true</trim>
          <charset>Cp1252</charset>
          <quotedValues>false</quotedValues>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>ProgramCode</con:property>
      <con:property>OfferCode</con:property>
      <con:property>OfferStartDate</con:property>
      <con:property>OfferEndDate</con:property>
      <con:property>OptInRequired</con:property>
      <con:property>DaysValid</con:property>
      <con:property>OfferName</con:property>
      <con:property>OfferName1</con:property>
      <con:property>OfferName2</con:property>
      <con:property>OfferName3</con:property>
      <con:property>OfferName4</con:property>
      <con:property>OfferName5</con:property>
      <con:property>OfferName6</con:property>
      <con:property>OfferShortDescription</con:property>
      <con:property>OfferShortDescription1</con:property>
      <con:property>OfferShortDescription2</con:property>
      <con:property>OfferShortDescription3</con:property>
      <con:property>OfferShortDescription4</con:property>
      <con:property>OfferShortDescription5</con:property>
      <con:property>OfferShortDescription6</con:property>
      <con:property>OfferDescription</con:property>
      <con:property>OfferDescription1</con:property>
      <con:property>OfferDescription2</con:property>
      <con:property>OfferDescription3</con:property>
      <con:property>OfferDescription4</con:property>
      <con:property>OfferDescription5</con:property>
      <con:property>OfferDescription6</con:property>
      <con:property>OfferTermsAndConditions</con:property>
      <con:property>OfferTermsAndConditions1</con:property>
      <con:property>OfferTermsAndConditions2</con:property>
      <con:property>OfferTermsAndConditions3</con:property>
      <con:property>OfferTermsAndConditions4</con:property>
      <con:property>OfferTermsAndConditions5</con:property>
      <con:property>OfferTermsAndConditions6</con:property>
      <con:property>UsageLimit</con:property>
      <con:property>RedemptionCodeReqInPurchase</con:property>
      <con:property>ImageNameSmall</con:property>
      <con:property>ImageNameMedium</con:property>
      <con:property>ImageNameLarge</con:property>
      <con:property>IsCouponOffer</con:property>
      <con:property>CustomDataName</con:property>
      <con:property>CustomDataValue</con:property>
      <con:property>GlobalLimit</con:property>
      <con:startRow>1</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="AddProgramOffer" id="9c75abef-86ed-4dcb-8d10-5f7964229f78">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/referencedata/programs/sysoffers" methodName="Add Program Offer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="AddProgramOffer" id="e6cd6a15-8800-4f34-912b-da1e6f9af091" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{
  "OfferCode":  "${=new java.text.SimpleDateFormat("yyyyMMddHHmmssFFFF").format(new Date()-2000)}${ProgramOffersGlobalLimit#OfferCode}",
  "OfferDescription": "${ProgramOffersGlobalLimit#OfferDescription}",
  "OfferStartDate": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()-1)}",
  "OfferEndDate": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()+500)}",
  "OfferShortDescription": "${ProgramOffersGlobalLimit#OfferShortDescription}",
  "OptInRequired": "${ProgramOffersGlobalLimit#OptInRequired}",
  "DaysValid": ${ProgramOffersGlobalLimit#DaysValid},
  "OfferName": "${ProgramOffersGlobalLimit#OfferName}",
  "OfferTermsAndConditions": "${ProgramOffersGlobalLimit#OfferTermsAndConditions}",
  "OfferName1": "${ProgramOffersGlobalLimit#OfferName1}",
  "OfferShortDescription1": "${ProgramOffersGlobalLimit#OfferShortDescription1}",
  "OfferDescription1":"${ProgramOffersGlobalLimit#OfferDescription1}",
  "OfferTermsAndConditions1": "${ProgramOffersGlobalLimit#OfferTermsAndConditions1}",
  "OfferName2": "${ProgramOffersGlobalLimit#OfferName2}",
  "OfferShortDescription2": "${ProgramOffersGlobalLimit#OfferShortDescription2}",
  "OfferDescription2": "${ProgramOffersGlobalLimit#OfferDescription2}",
  "OfferTermsAndConditions2": "${ProgramOffersGlobalLimit#OfferTermsAndConditions2}",
  "OfferName3": "${ProgramOffersGlobalLimit#OfferName3}",
  "OfferShortDescription3": "${ProgramOffersGlobalLimit#OfferShortDescription3}",
  "OfferDescription3": "${ProgramOffersGlobalLimit#OfferDescription3}",
  "OfferTermsAndConditions3": "${ProgramOffersGlobalLimit#OfferTermsAndConditions3}",
  "OfferName4": "${ProgramOffersGlobalLimit#OfferName4}",
  "OfferShortDescription4": "${ProgramOffersGlobalLimit#OfferShortDescription4}",
  "OfferDescription4": "${ProgramOffersGlobalLimit#OfferDescription4}",
  "OfferTermsAndConditions4": "${ProgramOffersGlobalLimit#OfferTermsAndConditions4}",
  "OfferName5": "${ProgramOffersGlobalLimit#OfferName5}",
  "OfferShortDescription5": "${ProgramOffersGlobalLimit#OfferShortDescription5}",
  "OfferDescription5": "${ProgramOffersGlobalLimit#OfferDescription5}",
  "OfferTermsAndConditions5": "${ProgramOffersGlobalLimit#OfferTermsAndConditions5}",
  "OfferName6": "${ProgramOffersGlobalLimit#OfferName6}",
  "OfferShortDescription6": "${ProgramOffersGlobalLimit#OfferShortDescription6}",
  "OfferDescription6": "${ProgramOffersGlobalLimit#OfferDescription6}",
  "OfferTermsAndConditions6": "${ProgramOffersGlobalLimit#OfferTermsAndConditions6}",
  "UsageLimit": ${ProgramOffersGlobalLimit#UsageLimit},
  "RedemptionCodeReqInPurchase": "${ProgramOffersGlobalLimit#RedemptionCodeReqInPurchase}",
  "ImageNameSmall": "${ProgramOffersGlobalLimit#ImageNameSmall}",
  "ImageNameMedium": "${ProgramOffersGlobalLimit#ImageNameMedium}",
  "ImageNameLarge": "${ProgramOffersGlobalLimit#ImageNameLarge}",
   "GlobalLimit":  ${ProgramOffersGlobalLimit#GlobalLimit},
"IsCouponOffer":"${ProgramOffersGlobalLimit#IsCouponOffer}",
   "Status": "A",
   "OfferCustomDataGroup": {
    "CustomData": [
      {
        "CustomDataName": "${ProgramOffersGlobalLimit#CustomDataName}",
        "CustomDataValue": "${ProgramOffersGlobalLimit#CustomDataValue}"
      }
  ]}
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/programs/sysoffers</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="c74fb113-8017-46f1-b6db-49a0e8d8683f" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>201</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="AddOfferCoupon" id="aeaf4113-93d6-4423-9855-0020f075d921">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/referencedata/offers/{sysOfferId}/coupons" methodName="Add Offer Coupon" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="AddOfferCoupon" id="20618720-2ce6-4993-a45b-4ea75252c6a0" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{
  "RedemptionCodeType": "AUTO_GENERATED",
  "IsIndividual": false
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/offers/8eca0252-e82c-4455-a799-5ec7ac6d10d7/coupons</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="e6ad8b59-4922-4719-8219-128be0b5a8c7" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>201</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
          <con:entry key="sysOfferId" value="${AddProgramOffer#Response#$['SysOfferId']}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>sysOfferId</con:entry>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetProgramOffers" id="e608fb7e-17be-48bd-8870-0dea4597363f">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/referencedata/programs/sysoffers" methodName="Get Program Offers" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetProgramOffers" id="01b55446-a40a-4369-9fab-5cac544244cc" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/programs/sysoffers</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="e261fb75-5ce2-43c2-a845-b67a85a33cb6" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="pageNumber" value=";`"/>
          <con:entry key="offerCode" value="${AddOffer#Response#$['OfferCode']}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
          <con:entry>offerCode</con:entry>
          <con:entry>offerName</con:entry>
          <con:entry>status</con:entry>
          <con:entry>shortDescription</con:entry>
          <con:entry>startDate</con:entry>
          <con:entry>endDate</con:entry>
          <con:entry>isCouponOffer</con:entry>
          <con:entry>offerType</con:entry>
          <con:entry>isDefaultOffer</con:entry>
          <con:entry>customDataName</con:entry>
          <con:entry>customDataValue</con:entry>
          <con:entry>sortBy</con:entry>
          <con:entry>numberPerPage</con:entry>
          <con:entry>pageNumber</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="AddProfile" id="02d9f37e-3cd6-413d-acbb-75db1e956513">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>09d0b29f-fbfa-4136-9573-3b813c1795b3</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>ProfileId</con:name>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="AddTransaction" id="a4bea214-492b-4500-ae35-a0f09176114d">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v2/transaction" methodName="ProcessTransaction" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest id="718bd064-a7af-4380-abb6-72819bd0b41a" mediaType="application/json" name="AddTransaction" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://q3alin-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{
	"ProfileId": "${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}",
	"TransactionTypeCode": "PR",
	"TransactionNetTotal": 1,
	"TransactionEligible": 1,
	"TransactionNumber": "ANTR${=new java.text.SimpleDateFormat("yyyyMMddHHmmssFFFF").format(new Date()-1)}",
	"CurrencyCode": "USD",
	"TransactionDateTime": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()+2)}",
	"TransactionEndDateTime": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()+3)}",
	"TransactionDescription": "ANTR${=new java.text.SimpleDateFormat("yyyyMMddHHmmssFFFF").format(new Date()-1)}",
	"StoreCode": "PP1502",
	"TransactionDetails": [
	{                                            
		"DollarValueGross": 1,
		"DollarValueNet": 1,
		"ItemNumber": "L1",
		"ItemNumberTypeCode": "C",
		"Quantity": 1,
		"LineNumber": 1                                            
	}
	],
	"Coupons": [
		{
			"CouponAmount": 1,
			"CouponNumber": "${AddOfferCoupon#Response#$['SysRedemptionCode']}"
		}
	], 
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v2/transaction</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="1c6d8cb5-2d63-4222-a2eb-fa9e191595a9" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="d653788f-b849-4013-8db6-47ad297cdee5">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="ValidateProfileOfferCoupon" id="4f444a4f-adb3-4d4a-956b-3055f3055345">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/profiles/sysoffers/coupons/validate" methodName="ValidateProfileProgramOfferCoupon" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="ValidateProfileOfferCoupon" id="98b64d61-72b3-4e8c-af50-6f8912cea366" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{ 
"SysRedemptionCode": "${AddOfferCoupon#Response#$['SysRedemptionCode']}"	
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/sysoffers/coupons/validate</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="a9cd18b7-1ef4-4863-a201-abba0c038c2f" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Match" id="8629fc83-ef26-4840-9a4d-35baa27c8067" name="JSONPath Match">
          <con:configuration>
            <path>$['IsGloballyRedeemed']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="AddOfferForAnonymous" id="2e020976-89ba-4d44-8970-8f9eec84a60e">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/referencedata/programs/sysoffers" methodName="Add Program Offer" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="AddOfferForAnonymous" id="e6cd6a15-8800-4f34-912b-da1e6f9af091" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{
  "OfferCode":  "${=new java.text.SimpleDateFormat("yyyyMMddHHmmssFFFF").format(new Date()+447)}${ProgramOffersGlobalLimit#OfferCode}",
  "OfferDescription": "${ProgramOffersGlobalLimit#OfferDescription}",
  "OfferStartDate": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()-1)}",
  "OfferEndDate": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()+500)}",
  "OfferShortDescription": "${ProgramOffersGlobalLimit#OfferShortDescription}",
  "OptInRequired": "${ProgramOffersGlobalLimit#OptInRequired}",
  "DaysValid": ${ProgramOffersGlobalLimit#DaysValid},
  "OfferName": "${ProgramOffersGlobalLimit#OfferName}",
  "OfferTermsAndConditions": "${ProgramOffersGlobalLimit#OfferTermsAndConditions}",
  "OfferName1": "${ProgramOffersGlobalLimit#OfferName1}",
  "OfferShortDescription1": "${ProgramOffersGlobalLimit#OfferShortDescription1}",
  "OfferDescription1":"${ProgramOffersGlobalLimit#OfferDescription1}",
  "OfferTermsAndConditions1": "${ProgramOffersGlobalLimit#OfferTermsAndConditions1}",
  "OfferName2": "${ProgramOffersGlobalLimit#OfferName2}",
  "OfferShortDescription2": "${ProgramOffersGlobalLimit#OfferShortDescription2}",
  "OfferDescription2": "${ProgramOffersGlobalLimit#OfferDescription2}",
  "OfferTermsAndConditions2": "${ProgramOffersGlobalLimit#OfferTermsAndConditions2}",
  "OfferName3": "${ProgramOffersGlobalLimit#OfferName3}",
  "OfferShortDescription3": "${ProgramOffersGlobalLimit#OfferShortDescription3}",
  "OfferDescription3": "${ProgramOffersGlobalLimit#OfferDescription3}",
  "OfferTermsAndConditions3": "${ProgramOffersGlobalLimit#OfferTermsAndConditions3}",
  "OfferName4": "${ProgramOffersGlobalLimit#OfferName4}",
  "OfferShortDescription4": "${ProgramOffersGlobalLimit#OfferShortDescription4}",
  "OfferDescription4": "${ProgramOffersGlobalLimit#OfferDescription4}",
  "OfferTermsAndConditions4": "${ProgramOffersGlobalLimit#OfferTermsAndConditions4}",
  "OfferName5": "${ProgramOffersGlobalLimit#OfferName5}",
  "OfferShortDescription5": "${ProgramOffersGlobalLimit#OfferShortDescription5}",
  "OfferDescription5": "${ProgramOffersGlobalLimit#OfferDescription5}",
  "OfferTermsAndConditions5": "${ProgramOffersGlobalLimit#OfferTermsAndConditions5}",
  "OfferName6": "${ProgramOffersGlobalLimit#OfferName6}",
  "OfferShortDescription6": "${ProgramOffersGlobalLimit#OfferShortDescription6}",
  "OfferDescription6": "${ProgramOffersGlobalLimit#OfferDescription6}",
  "OfferTermsAndConditions6": "${ProgramOffersGlobalLimit#OfferTermsAndConditions6}",
  "UsageLimit": ${ProgramOffersGlobalLimit#UsageLimit},
  "RedemptionCodeReqInPurchase": "${ProgramOffersGlobalLimit#RedemptionCodeReqInPurchase}",
  "ImageNameSmall": "${ProgramOffersGlobalLimit#ImageNameSmall}",
  "ImageNameMedium": "${ProgramOffersGlobalLimit#ImageNameMedium}",
  "ImageNameLarge": "${ProgramOffersGlobalLimit#ImageNameLarge}",
   "GlobalLimit":  ${ProgramOffersGlobalLimit#GlobalLimit},
"IsCouponOffer":"${ProgramOffersGlobalLimit#IsCouponOffer}",
   "Status": "A",
   "OfferCustomDataGroup": {
    "CustomData": [
      {
        "CustomDataName": "${ProgramOffersGlobalLimit#CustomDataName}",
        "CustomDataValue": "${ProgramOffersGlobalLimit#CustomDataValue}"
      }
  ]}
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/programs/sysoffers</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="c74fb113-8017-46f1-b6db-49a0e8d8683f" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>201</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="AddOfferCouponForAnonymous" id="e8bdfbb4-46ad-4705-90b7-48ed647e94c0">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/referencedata/offers/{sysOfferId}/coupons" methodName="Add Offer Coupon" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="AddOfferCouponForAnonymous" id="20618720-2ce6-4993-a45b-4ea75252c6a0" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{
  "RedemptionCodeType": "AUTO_GENERATED",
  "IsIndividual": false
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/offers/8eca0252-e82c-4455-a799-5ec7ac6d10d7/coupons</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="e6ad8b59-4922-4719-8219-128be0b5a8c7" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>201</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
          <con:entry key="sysOfferId" value="${AddOfferForAnonymous#Response#$['SysOfferId']}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>sysOfferId</con:entry>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="AddAnonymousTransaction" id="e135575e-b16c-4143-90f5-ae1470b60d40">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v2/transaction" methodName="ProcessTransaction" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest id="718bd064-a7af-4380-abb6-72819bd0b41a" mediaType="application/json" name="AddAnonymousTransaction" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://q3alin-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{
	"ProfileId": "${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}",
	"TransactionTypeCode": "PR",
	"TransactionNetTotal": 1,
	"TransactionEligible": 1,
	"TransactionNumber": "ANTR${=new java.text.SimpleDateFormat("yyyyMMddHHmmssFFFF").format(new Date()-1)}",
	"CurrencyCode": "USD",
	"TransactionDateTime": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()+2)}",
	"TransactionEndDateTime": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ").format(new Date()+3)}",
	"TransactionDescription": "ANTR${=new java.text.SimpleDateFormat("yyyyMMddHHmmss").format(new Date()-1)}",
	"StoreCode": "PP1502",
	"TransactionDetails": [
	{                                            
		"DollarValueGross": 1,
		"DollarValueNet": 1,
		"ItemNumber": "L1",
		"ItemNumberTypeCode": "C",
		"Quantity": 1,
		"LineNumber": 1                                            
	}
	],
	"Coupons": [
		{
			"CouponAmount": 1,
			"CouponNumber": "${AddOfferCouponForAnonymous#Response#$['SysRedemptionCode']}"
		}
	], 
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v2/transaction</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="1c6d8cb5-2d63-4222-a2eb-fa9e191595a9" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="d653788f-b849-4013-8db6-47ad297cdee5">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="ValidateProfileOfferCouponForAnonymous" id="7944769e-b660-4d2b-b5fe-2367a135cdef">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/profiles/sysoffers/coupons/validate" methodName="ValidateProfileProgramOfferCoupon" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="ValidateProfileOfferCouponForAnonymous" id="98b64d61-72b3-4e8c-af50-6f8912cea366" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{ 
"SysRedemptionCode": "${AddOfferCouponForAnonymous#Response#$['SysRedemptionCode']}"	
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/sysoffers/coupons/validate</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="a9cd18b7-1ef4-4863-a201-abba0c038c2f" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Match" id="8629fc83-ef26-4840-9a4d-35baa27c8067" name="JSONPath Match">
          <con:configuration>
            <path>$['IsGloballyRedeemed']</path>
            <content>true</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>8d88c5c1-6f70-4730-9209-c5833dba2006</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>e8bdfbb4-46ad-4705-90b7-48ed647e94c0</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>9c75abef-86ed-4dcb-8d10-5f7964229f78</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
  <con:breakPoints>
    <con:testStepId>2e020976-89ba-4d44-8970-8f9eec84a60e</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
