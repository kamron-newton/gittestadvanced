<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="55ca3426-89c4-4067-9d84-207eaf6d0038" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="ProfileTierProgressWithPoints" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="55ca3426-89c4-4067-9d84-207eaf6d0038fileName">ProfileTierProgressWithPoints</con:setting>
  </con:settings>
  <con:testStep type="datasource" name="PointTypes" id="1a743d0a-4216-4ccc-a291-99ad09bb7a29">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="File">
        <con:configuration>
          <fileName>${#Project#ProjectPath}/References/PointTypes.csv</fileName>
          <separator>,</separator>
          <trim>true</trim>
          <charset>Cp1252</charset>
          <quotedValues>false</quotedValues>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>PointTypeCode</con:property>
      <con:property>PointTypeDescription</con:property>
      <con:property>PointTypeShortDescription</con:property>
      <con:property>RedeemableInd</con:property>
      <con:property>IsGiftable</con:property>
      <con:property>SubType1Code</con:property>
      <con:property>SubType1ShortDesc</con:property>
      <con:property>SubType1Desc</con:property>
      <con:property>SubType1ExpiryInd</con:property>
      <con:property>SubType1ExpiryTimeUnit</con:property>
      <con:property>SubType1ExpiryTimeValue</con:property>
      <con:property>SubType2Code</con:property>
      <con:property>SubType2ShortDesc</con:property>
      <con:property>SubType2Desc</con:property>
      <con:property>SubType2ExpiryInd</con:property>
      <con:property>SubType2ExpiryTimeUnit</con:property>
      <con:property>SubType2ExpiryTimeValue</con:property>
      <con:property>CostPerPoint</con:property>
      <con:property>CurrencyCode</con:property>
      <con:startRow>1</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="MomentForPointAggregate" id="07e372f8-fc04-4003-a2d5-9ce2f6be6d8d">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="File">
        <con:configuration>
          <fileName>${#Project#ProjectPath}/References/MomentForPointAggregate.csv</fileName>
          <separator>,</separator>
          <trim>true</trim>
          <charset>Cp1252</charset>
          <quotedValues>true</quotedValues>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>ProgramCode</con:property>
      <con:property>MomentCode</con:property>
      <con:property>MomentType</con:property>
      <con:property>BaseInd</con:property>
      <con:property>PointTypeVal</con:property>
      <con:property>PointSubTypeVal</con:property>
      <con:property>Description</con:property>
      <con:property>QualifyingDateAttribute</con:property>
      <con:property>EventType</con:property>
      <con:property>OfferName</con:property>
      <con:property>CalculationTemplate</con:property>
      <con:property>OutcomeEquationTemplate</con:property>
      <con:property>FormulaName</con:property>
      <con:property>RuleEquationUI</con:property>
      <con:property>OutcomeEquationUiVal</con:property>
      <con:startRow>1</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="PurchaseTransaction" id="d09a0eff-480c-4ece-83ca-3b34218e5e1b">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="File">
        <con:configuration>
          <fileName>${#Project#ProjectPath}/References/PurchaseTransaction.csv</fileName>
          <separator>,</separator>
          <trim>true</trim>
          <charset>Cp1252</charset>
          <quotedValues>false</quotedValues>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>ProgramCode</con:property>
      <con:property>TransactionTypeCode</con:property>
      <con:property>TransactionNetTotal</con:property>
      <con:property>TransactionEligible</con:property>
      <con:property>ShippingAndHandling</con:property>
      <con:property>TransactionTotalTax</con:property>
      <con:property>TransNumber</con:property>
      <con:property>CurrencyCode</con:property>
      <con:property>PostingDateTime</con:property>
      <con:property>TransDate</con:property>
      <con:property>OnlyAddTransData</con:property>
      <con:property>SuspendTransaction</con:property>
      <con:property>TransactionDescription</con:property>
      <con:property>StoreCode</con:property>
      <con:property>GrossAmount</con:property>
      <con:property>TaxAmount</con:property>
      <con:property>DollarValueGross</con:property>
      <con:property>DollarValueNet</con:property>
      <con:property>ItemNumber1</con:property>
      <con:property>ItemNumber2</con:property>
      <con:property>Quantity</con:property>
      <con:property>ItemNumberTypeCode</con:property>
      <con:property>CouponAmount1</con:property>
      <con:property>CouponAmount2</con:property>
      <con:property>CouponNumber1</con:property>
      <con:property>CouponNumber2</con:property>
      <con:property>CouponNumber3</con:property>
      <con:property>CouponNumber4</con:property>
      <con:property>CouponNumber5</con:property>
      <con:property>CouponNumber6</con:property>
      <con:property>TenderCode1</con:property>
      <con:property>TenderCode2</con:property>
      <con:property>TenderAmount1</con:property>
      <con:property>TenderAmount2</con:property>
      <con:property>CustomDataName1</con:property>
      <con:property>CustomDataDescription1</con:property>
      <con:property>CustomDataValue1</con:property>
      <con:property>CustomDataName2</con:property>
      <con:property>CustomDataDescription2</con:property>
      <con:property>CustomDataValue2</con:property>
      <con:property>ThreeQuantity</con:property>
      <con:property>FiveQuantity</con:property>
      <con:property>TransactionNetTotal100</con:property>
      <con:property>TransactionNetTotal120</con:property>
      <con:property>DollarValueGrossPr1</con:property>
      <con:property>DollarValueNetPr1</con:property>
      <con:property>TransactionNetTotal175</con:property>
      <con:property>DollarValueGross180</con:property>
      <con:property>DollarValueNet175</con:property>
      <con:property>DollarValueGross30</con:property>
      <con:property>DollarValueNet25</con:property>
      <con:property>DollarValueGross25</con:property>
      <con:property>DollarValueNet20</con:property>
      <con:property>FourQuantity</con:property>
      <con:property>DollarValueGross60</con:property>
      <con:property>DollarValueNet55</con:property>
      <con:property>ItemNumber3</con:property>
      <con:property>TransactionNetTotal6300</con:property>
      <con:property>TransactionGross6310</con:property>
      <con:property>DollarValueGross6300</con:property>
      <con:property>DollarValueNet6310</con:property>
      <con:property>TransactionNetTotal230</con:property>
      <con:property>TransactionGross235</con:property>
      <con:property>DollarValueGross230</con:property>
      <con:property>DollarValueNet235</con:property>
      <con:property>TransactionNetTotal510</con:property>
      <con:property>TransactionGross515</con:property>
      <con:property>DollarValueGross510</con:property>
      <con:property>DollarValueNet515</con:property>
      <con:property>TransactionNetTotal389</con:property>
      <con:property>TransactionGross395</con:property>
      <con:property>DollarValueGross389</con:property>
      <con:property>DollarValueNet395</con:property>
      <con:property>TransactionNetTotal698</con:property>
      <con:property>TransactionGross699</con:property>
      <con:property>DollarValueGross698</con:property>
      <con:property>DollarValueNet699</con:property>
      <con:property>P1TranDate</con:property>
      <con:property>E1TranDate</con:property>
      <con:property>SixQuantity</con:property>
      <con:property>TwoQuantity</con:property>
      <con:property>P1ItemNumber3</con:property>
      <con:property>P1NetTotal</con:property>
      <con:property>P1GrossAmount</con:property>
      <con:property>TransactionNetTotal10025</con:property>
      <con:property>GrossAmount11025</con:property>
      <con:property>TransactionNetTotal2000</con:property>
      <con:property>SevenQuantity</con:property>
      <con:property>TransactionNetTotal400</con:property>
      <con:property>GrossAmount410</con:property>
      <con:property>TransactionNetTotal4000</con:property>
      <con:property>GrossAmount4100</con:property>
      <con:property>TransactionNetTotal1000</con:property>
      <con:property>GrossAmount1100</con:property>
      <con:property>StoreCodePP1502</con:property>
      <con:property>ItemNumberEggs</con:property>
      <con:property>ItemNumberHotCake</con:property>
      <con:property>PRTxnNumberForProfileSearch</con:property>
      <con:property>VDTxnNumberForProfileSearch</con:property>
      <con:property>RTTxnNumberForProfileSearch</con:property>
      <con:property>EXTxnNumberForProfileSearch</con:property>
      <con:property>VoidTxnNumberForProfileSearch</con:property>
      <con:property>SupndTxnNumberForProfileSearch</con:property>
      <con:property>AnonTxnNumberForProfileSearch</con:property>
      <con:property>TransactionNetTotalCyclic</con:property>
      <con:property>TransactionEligibleCyclic</con:property>
      <con:property>NetAmount</con:property>
      <con:startRow>1</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="ProgramSetting" id="63c3b741-cb1b-4803-8228-eead6de4ea95">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="File">
        <con:configuration>
          <fileName>${#Project#ProjectPath}/References/ProgramSetting.csv</fileName>
          <separator>,</separator>
          <trim>true</trim>
          <charset>Cp1252</charset>
          <quotedValues>false</quotedValues>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>ProgramCode</con:property>
      <con:property>ParameterName</con:property>
      <con:property>ParameterValue</con:property>
      <con:property>ParameterValue1</con:property>
      <con:property>ParameterName1</con:property>
      <con:property>ParamNameLinkAnon</con:property>
      <con:property>ParamValueLinkAnon</con:property>
      <con:property>ParamNamePointGift</con:property>
      <con:property>ParamValuePointGift</con:property>
      <con:property>ParamValuePointGift1</con:property>
      <con:property>ParamNameGiftHeld</con:property>
      <con:property>ParamValueGiftHeld</con:property>
      <con:property>ParamValueGiftHeld1</con:property>
      <con:property>ParamNameGiftGiverAppvl</con:property>
      <con:property>ParamValueGiftGiverAppvl</con:property>
      <con:property>ParamValueGiftGiverAppvl1</con:property>
      <con:property>ParamNameGiftGiverConfn</con:property>
      <con:property>ParamValueGiftGiverConfn</con:property>
      <con:property>ParamValueGiftGiverConfn1</con:property>
      <con:property>ParamNameGiftRecptAccpt</con:property>
      <con:property>ParamValueGiftRecptAccpt</con:property>
      <con:property>ParamValueGiftRecptAccpt1</con:property>
      <con:property>ParamNameGiftRecptConfn</con:property>
      <con:property>ParamValueGiftRecptConfn</con:property>
      <con:property>ParamValueGiftRecptConfn1</con:property>
      <con:property>ParamNameForPooling</con:property>
      <con:property>ParamAddStan</con:property>
      <con:property>StoreAddStan</con:property>
      <con:property>ParamNameEnablePendingTrans</con:property>
      <con:startRow>1</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="TierProgression" id="b5c08dd6-c200-441e-a643-711ab8ff5c10">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="File">
        <con:configuration>
          <fileName>${#Project#ProjectPath}/References/TierProgression.csv</fileName>
          <separator>,</separator>
          <trim>true</trim>
          <charset>Cp1252</charset>
          <quotedValues>false</quotedValues>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>AggregateType1</con:property>
      <con:property>AggregateCode1</con:property>
      <con:property>AggregateDesc1</con:property>
      <con:property>AggregateCode2</con:property>
      <con:property>AggregateDesc2</con:property>
      <con:property>AggregateCode3</con:property>
      <con:property>AggregateDesc3</con:property>
      <con:property>AggregateCode4</con:property>
      <con:property>AggregateDesc4</con:property>
      <con:property>AggregateType2</con:property>
      <con:property>TierCodeLevel3</con:property>
      <con:property>TierCodeLevel2</con:property>
      <con:property>TierCodeLevel1</con:property>
      <con:startRow>1</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="datasource" name="MomentsUpdate" id="eabcc6f9-5c3f-4f4b-978b-69b7009819f1">
    <con:settings/>
    <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:dataSource type="File">
        <con:configuration>
          <fileName>${#Project#ProjectPath}/References/MomentsUpdate.csv</fileName>
          <separator>,</separator>
          <trim>true</trim>
          <charset>Cp1252</charset>
          <quotedValues>false</quotedValues>
        </con:configuration>
      </con:dataSource>
      <con:shared>true</con:shared>
      <con:restartShared>true</con:restartShared>
      <con:property>row</con:property>
      <con:property>ProgramCode</con:property>
      <con:property>MomentCode</con:property>
      <con:property>MomentType</con:property>
      <con:property>BaseInd</con:property>
      <con:property>PointTypeVal</con:property>
      <con:property>PointSubTypeVal</con:property>
      <con:property>StartDate</con:property>
      <con:property>EndDate</con:property>
      <con:property>Description</con:property>
      <con:property>QualifyingDateAttribute</con:property>
      <con:property>QualifyingDateAttributeDrools</con:property>
      <con:property>EventType</con:property>
      <con:property>OfferName</con:property>
      <con:property>CalculationTemplate</con:property>
      <con:property>OutcomeEquationTemplate</con:property>
      <con:property>OutcomeEquationDrools1</con:property>
      <con:property>OutcomeEquationDrools2</con:property>
      <con:property>OutcomeEquationDrools3</con:property>
      <con:property>FormulaName</con:property>
      <con:property>RuleEquationUI1</con:property>
      <con:property>RuleEquationUI2</con:property>
      <con:property>RuleEquationDrools1</con:property>
      <con:property>RuleEquationDrools2</con:property>
      <con:property>OutcomeEquationUiVal</con:property>
      <con:property>LeafValue</con:property>
      <con:property>OutcomeEquationTemplate1</con:property>
      <con:property>OutcomeEquationTemplate2</con:property>
      <con:property>ValueGroup</con:property>
      <con:startRow>1</con:startRow>
      <con:endRow/>
      <con:recordsPerIteration>1</con:recordsPerIteration>
      <con:completeLastOperation>true</con:completeLastOperation>
      <con:trimValues>false</con:trimValues>
      <con:entitizeValues>false</con:entitizeValues>
      <con:restartOnRun>true</con:restartOnRun>
      <con:expandProperties>false</con:expandProperties>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetPointTypes" id="df0dbd1e-200c-4d6a-8afb-5e3057c5a095">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/referencedata/transactions/pointtypes" methodName="GetPointTypes" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest id="41d772c9-42ab-4326-8052-f61f2a44d3be" mediaType="application/json" name="GetPointTypes">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://q3alin-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/transactions/pointtypes</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="17ae109c-c23e-439f-9614-eceff987b4e3" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="pointTypeCode" value="${PointTypes#PointTypeCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>Authorization</con:entry>
          <con:entry>Accept-Language</con:entry>
          <con:entry>status</con:entry>
          <con:entry>isGiftable</con:entry>
          <con:entry>redeemableInd</con:entry>
          <con:entry>pointTypeCode</con:entry>
          <con:entry>pointTypeShortDescription</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="d653788f-b849-4013-8db6-47ad297cdee5">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetPointSubType" id="cd2341b0-ecef-4a32-ba4a-b96d30b59984">
    <con:settings/>
    <con:config service="RestAPIs" methodName="GetPointSubType" resourcePath="/api/v1/validvaluesadmin/validvalue/{valuegroup}" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetPointSubType" id="68c9f996-dc32-4ee2-b29e-6e4ff8b0109f" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/validvaluesadmin/validvalue/POINT%20TYPE</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="23c6648f-136d-4c0f-831c-d1d3321ceeeb" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="valuegroup" value="POINT TYPE"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="node1Value" value="${GetPointTypes#Response#$[0]['RefPointTypeId']}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="UpsertMoment" id="2a5682b9-5199-4a33-8f26-10efcb9a0152">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>58a85117-5558-4be0-b68f-214c9fbde4c3</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>MomentName</con:name>
          <con:value>${MomentForPointAggregate#MomentCode}</con:value>
        </con:property>
        <con:property>
          <con:name>CreateBody</con:name>
          <con:value>{   "Description": "${MomentForPointAggregate#Description}",   "MomentCode": "${MomentForPointAggregate#MomentCode}",   "MomentResponseValues": [     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "BASE INDICATOR",       "ResponsePropertyValue": "N",       "Status": "A",     },     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "ENGAGE INDICATOR",       "ResponsePropertyValue": "N",       "Status": "A",     },     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "POINT SUBTYPE",       "ResponsePropertyValue": "${GetPointSubType#Response#$[?(@.Description == "${MomentsUpdate#PointSubTypeVal}")].['Value'][0]}",       "Status": "A",     },     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "POINT TYPE",       "ResponsePropertyValue": "${GetPointTypes#Response#$[?(@.PointTypeCode=='${PointTypes#PointTypeCode}')].['RefPointTypeId'][0]}",       "Status": "A",     }   ],   "MomentType": "PROMOTIONAL_CURRENCY",   "StartDate": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'00:00:00Z").format(new Date())}",   "StartDateString" : "${=new java.text.SimpleDateFormat("MM/dd/yyyy 12:00:00 'tt'").format(new Date())}",   "EndDate": "${=new java.text.SimpleDateFormat("yyyy-12-31'T'23:59:59Z").format(new Date())}",   "EndDateString" : "${=new java.text.SimpleDateFormat("12/31/yyyy 11:59:59 'tt'").format(new Date())}",   "MomentStatus": "A",   "MomentEvent": {     "MomentCode": "${MomentForPointAggregate#MomentCode}",     "EventType": "PurchaseTxn",     "MomentQualifyingDateAttribute": "${MomentForPointAggregate#QualifyingDateAttribute}",     "MomentQualifyingDateAttributeDrools": "$PurchaseTxn:PurchaseTxnC(isItBetween( new Date() ,\"${=new java.text.SimpleDateFormat("MM/dd/yyyy 12:00:00 'tt'").format(new Date())}\",\"${=new java.text.SimpleDateFormat("yyyy-12-31'T'23:59:59Z").format(new Date())}\"))",     "MomentOffers": [       {         "MomentCode": "${MomentForPointAggregate#MomentCode}",         "EventType": "${MomentForPointAggregate#EventType}",         "OfferName": "${MomentForPointAggregate#MomentCode}",         "Description": "${MomentForPointAggregate#Description}",         "MomentOutcome": {           "MomentCode": "${MomentForPointAggregate#MomentCode}",           "EventType": "${MomentForPointAggregate#EventType}",           "OfferName": "${MomentForPointAggregate#MomentCode}",           "OutcomeEquationUi": "${MomentForPointAggregate#OutcomeEquationUiVal}",           "CalculationTemplate": "${MomentForPointAggregate#CalculationTemplate}",           "OutcomeEquationTemplate": "%5B%7B%22name%22%3A%22fixedpoints%22%2C%22type%22%3A%22Number%22%2C%22objType%22%3A%22var%22%2C%22id%22%3A%22variable_0%22%2C%22value%22%3A%2243%22%2C%22isSelect%22%3Afalse%2C%22funcName%22%3A%22%22%2C%22filterType%22%3A%22%22%2C%22drools%22%3A%22%22%2C%22collectionAttribute%22%3Afalse%2C%22refId%22%3A%22%22%7D%2C%7B%22name%22%3A%22%22%2C%22type%22%3A%22%22%2C%22objType%22%3A%22drools%22%2C%22id%22%3A%22%22%2C%22value%22%3A%22String.valueOf(43)%22%2C%22isSelect%22%3Afalse%2C%22funcName%22%3A%22%22%2C%22filterType%22%3A%22%22%2C%22drools%22%3A%22%22%2C%22collectionAttribute%22%3Afalse%2C%22refId%22%3A%22%22%7D%5D",           "OutcomeEquationDrools": "MomentParam[] params = new MomentParam[] {new MomentParam(\"OfferName\",\"AGGMOMENT\"),new MomentParam(\"QualifiedAttribute\",$returnList),new MomentParam(\"QualifyingDateAttributeValue\", new Date() )};\nMomentParam[] outcomeValues = null;\nmo.add(new MomentOutcome(\"AGGMOMENT\",String.valueOf(43),params, outcomeValues));\n",           "FormulaName": "${MomentForPointAggregate#FormulaName}",           "Status": "A",         },         "MomentQualifyingRule": {           "MomentCode": "${MomentForPointAggregate#MomentCode}}",           "EventType": "${MomentForPointAggregate#EventType}",           "OfferName": "${MomentForPointAggregate#MomentCode}",           "RuleEquationUI": "${MomentForPointAggregate#RuleEquationUI}",           "RuleEquationDrools": "PurchaseTxnC(TransactionNetTotal == 0.99 &amp;&amp; ProgramCode == \"PP\")\n accumulate($item : PurchaseTxn.TransactionDetailsC() from $PurchaseTxn.TransactionDetails, $returnList : collectList($item.getItemNumber()))",           "Status": "A",         },         "Status": "A", } ], "Status": "A", }, "BestOfferIndicator": false, "AdvancedModeIndicator": false, "ReleaseState": "P", "IsTestUser": false, "Status": "A", }</con:value>
        </con:property>
        <con:property>
          <con:name>UpdateBody</con:name>
          <con:value>{   "Description": "${MomentForPointAggregate#Description}",   "MomentCode": "${MomentForPointAggregate#MomentCode}",   "MomentResponseValues": [     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "BASE INDICATOR",       "ResponsePropertyValue": "N",       "Status": "A",     },     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "ENGAGE INDICATOR",       "ResponsePropertyValue": "N",       "Status": "A",     },     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "POINT SUBTYPE",       "ResponsePropertyValue": "${GetPointSubType#Response#$[?(@.Description == "${MomentsUpdate#PointSubTypeVal}")].['Value'][0]}",       "Status": "A",     },     {       "MomentCode": "${MomentForPointAggregate#MomentCode}",       "MomentType": "PROMOTIONAL_CURRENCY",       "ResponsePropertyName": "POINT TYPE",       "ResponsePropertyValue": "${GetPointTypes#Response#$[?(@.PointTypeCode=='${PointTypes#PointTypeCode}')].['RefPointTypeId'][0]}",       "Status": "A",     }   ],   "MomentType": "PROMOTIONAL_CURRENCY",   "StartDate": "${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'00:00:00Z").format(new Date())}",   "StartDateString" : "${=new java.text.SimpleDateFormat("MM/dd/yyyy 12:00:00 'tt'").format(new Date())}",   "EndDate": "${=new java.text.SimpleDateFormat("yyyy-12-31'T'23:59:59Z").format(new Date())}",   "EndDateString" : "${=new java.text.SimpleDateFormat("12/31/yyyy 11:59:59 'tt'").format(new Date())}",   "MomentStatus": "A",   "MomentEvent": {     "MomentCode": "${MomentForPointAggregate#MomentCode}",     "EventType": "PurchaseTxn",     "MomentQualifyingDateAttribute": "${MomentForPointAggregate#QualifyingDateAttribute}",     "MomentQualifyingDateAttributeDrools": "$PurchaseTxn:PurchaseTxnC(isItBetween( new Date() ,\"${=new java.text.SimpleDateFormat("MM/dd/yyyy 12:00:00 'tt'").format(new Date())}\",\"${=new java.text.SimpleDateFormat("yyyy-12-31'T'23:59:59Z").format(new Date())}\"))",     "MomentOffers": [       {         "MomentCode": "${MomentForPointAggregate#MomentCode}",         "EventType": "${MomentForPointAggregate#EventType}",         "OfferName": "${MomentForPointAggregate#MomentCode}",         "Description": "${MomentForPointAggregate#Description}",         "MomentOutcome": {           "MomentCode": "${MomentForPointAggregate#MomentCode}",           "EventType": "${MomentForPointAggregate#EventType}",           "OfferName": "${MomentForPointAggregate#MomentCode}",           "OutcomeEquationUi": "${MomentForPointAggregate#OutcomeEquationUiVal}",           "CalculationTemplate": "${MomentForPointAggregate#CalculationTemplate}",           "OutcomeEquationTemplate": "%5B%7B%22name%22%3A%22fixedpoints%22%2C%22type%22%3A%22Number%22%2C%22objType%22%3A%22var%22%2C%22id%22%3A%22variable_0%22%2C%22value%22%3A%2243%22%2C%22isSelect%22%3Afalse%2C%22funcName%22%3A%22%22%2C%22filterType%22%3A%22%22%2C%22drools%22%3A%22%22%2C%22collectionAttribute%22%3Afalse%2C%22refId%22%3A%22%22%7D%2C%7B%22name%22%3A%22%22%2C%22type%22%3A%22%22%2C%22objType%22%3A%22drools%22%2C%22id%22%3A%22%22%2C%22value%22%3A%22String.valueOf(43)%22%2C%22isSelect%22%3Afalse%2C%22funcName%22%3A%22%22%2C%22filterType%22%3A%22%22%2C%22drools%22%3A%22%22%2C%22collectionAttribute%22%3Afalse%2C%22refId%22%3A%22%22%7D%5D",           "OutcomeEquationDrools": "MomentParam[] params = new MomentParam[] {new MomentParam(\"OfferName\",\"AGGMOMENT\"),new MomentParam(\"QualifiedAttribute\",$returnList),new MomentParam(\"QualifyingDateAttributeValue\", new Date() )};\nMomentParam[] outcomeValues = null;\nmo.add(new MomentOutcome(\"AGGMOMENT\",String.valueOf(43),params, outcomeValues));\n",           "FormulaName": "${MomentForPointAggregate#FormulaName}",           "Status": "A",         },         "MomentQualifyingRule": {           "MomentCode": "${MomentForPointAggregate#MomentCode}}",           "EventType": "${MomentForPointAggregate#EventType}",           "OfferName": "${MomentForPointAggregate#MomentCode}",           "RuleEquationUI": "${MomentForPointAggregate#RuleEquationUI}",           "RuleEquationDrools": "PurchaseTxnC(TransactionNetTotal == 0.99 &amp;&amp; ProgramCode == \"PP\")\n accumulate($item : PurchaseTxn.TransactionDetailsC() from $PurchaseTxn.TransactionDetails, $returnList : collectList($item.getItemNumber()))",           "Status": "A",         },         "Status": "A", } ], "Status": "A", }, "BestOfferIndicator": false, "AdvancedModeIndicator": false, "ReleaseState": "P", "IsTestUser": false, "Status": "A", }</con:value>
        </con:property>
        <con:property>
          <con:name>MomentId</con:name>
          <con:value>${#[Moment#UpsertMoment#GetMomentByMomentCode]#Response#$['MomentId']}</con:value>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetPendingTransactionSetting" id="204be37f-555c-4620-af99-f016b8cc0cb6">
    <con:settings/>
    <con:config service="RestAPIs" methodName="GetProgramSettings" resourcePath="/api/v1/referencedata/programs/programsettings" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetPendingTransactionSetting" id="245cbaa1-0074-4c46-b653-28594b5ea968" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/programs/programsettings</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="b8b49506-6b6c-4730-b182-2df94be40fca" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="parameterName" value="${ProgramSetting#ParamNameEnablePendingTrans}"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="VerifyEnablePendingTransaction" id="e75a95fe-6a7a-4ca3-a698-2b615d933770">
    <con:settings/>
    <con:config>
      <script>import static com.jayway.jsonpath.JsonPath.parse

def enablePendingTransaction = context.expand( '${GetPendingTransactionSetting#Response#$[?(@.ParameterName=="${ProgramSetting#ParamNameEnablePendingTrans}")][\'ParameterValue\']}' )

if (enablePendingTransaction == "Y")  testRunner.gotoStepByName("EnableORDisableProgramSetting")</script>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="EnableORDisableProgramSetting" id="7042e938-b076-48ca-8c1c-cba27b176358">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>58358ab6-63cb-4437-8821-6fda8375ad78</con:targetTestCase>
      <con:properties/>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="AddProfileTierProgress" id="178da5ef-b6a2-44d4-9740-210e985ab1c5">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>09d0b29f-fbfa-4136-9573-3b813c1795b3</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>ProfileId</con:name>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetTierProgressionAggregates" id="02e96088-66be-4382-9eaa-b4118bfd7447">
    <con:settings/>
    <con:config service="RestAPIs" methodName="GetTierProgressionAggregates" resourcePath="/api/v1/referencedata/programs/tierprogressions/aggregates" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetTierProgressionAggregates" id="6ac11567-7020-4fb0-838e-6acdaf28cbe9" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/programs/tierprogressions/aggregates</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="f77499da-1c73-459c-8940-41675933b1e4" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetCurrentTierProgressionCode" id="09f7e75a-ff96-4123-8619-8c1fe3549289">
    <con:settings/>
    <con:config service="RestAPIs" methodName="GetProfileTierProgress" resourcePath="/api/v1/profiles/{profileId}/dashboard/tiers/progress" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetCurrentTierProgressionCode" id="be14e729-a70d-4882-babe-5429bc20ab70" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/dashboard/tiers/progress</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="c6aa4266-b5fe-4d63-b522-8541c12e4085" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="profileId" value="${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}"/>
          <con:entry key="tierProgressionDate" value="${=new java.text.SimpleDateFormat(&quot;yyyy-MM-dd&quot;).format(new Date())}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="VerifyTierProgressionCode" id="70769a8f-2b22-4425-8d50-db94e211e119">
    <con:settings/>
    <con:config>
      <script>import static com.jayway.jsonpath.JsonPath.parse

def tierProgressionode = context.expand('${GetCurrentTierProgressionCode#Response#$[\'TierProgression\'][\'TierProgressionCode\']}')

if (tierProgressionode != "")  testRunner.gotoStepByName("UpdateTierProgression")</script>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="UpdateTierProgression" id="73bd0cbd-d37e-4231-92f7-57c8898cce83">
    <con:settings/>
    <con:config service="RestAPIs" methodName="ProcessTierProgression" resourcePath="/api/v1/referencedata/programs/tierprogressions" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="UpdateTierProgression" id="a77d9f20-d05d-43d5-908f-afb1d165c797" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{
  "TierProgressionCode": "${GetCurrentTierProgressionCode#Response#$['TierProgression']['TierProgressionCode']}",
  "ProgramCode": "${#Project#ProgramCode}",
  "StartDate": "${=new java.text.SimpleDateFormat("yyyy-01-01'T'00:00:00Z").format(new Date()-5)}",
  "EndDate": "${=new java.text.SimpleDateFormat("yyyy-12-31'T'00:00:00Z").format(new Date())}",
  "TierProgressionCycle": 1,
  "TierProgressionFrequency": "Y",
  "Chains": [
    {
      "TierCode": "${TierProgression#TierCodeLevel3}",
      "Aggregates": [
        {
          "AggregateCode": "${TierProgression#AggregateCode1}",
          "AggregateDesc": "${TierProgression#AggregateDesc1}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 0,
          "AggregateOperator": "AND"
        },
        {
          "AggregateCode": "${TierProgression#AggregateCode2}",
          "AggregateDesc": "${TierProgression#AggregateDesc2}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 0,
           "AggregateOperator": "OR"
        },
      {
          "AggregateCode": "${TierProgression#AggregateCode3}",
          "AggregateDesc": "${TierProgression#AggregateDesc3}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 0,
          "AggregateOperator": "AND"
        },
        {
          "AggregateCode": "${TierProgression#AggregateCode4}",
          "AggregateDesc": "${TierProgression#AggregateDesc4}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 0,
          "AggregateOperator": "OR"
        },
        {
          "AggregateCode": "HATCHED",
          "AggregateType": "${TierProgression#AggregateType2}",
          "AnnualThreshold": 0
        }
      ]
    },
    {
      "TierCode": "${TierProgression#TierCodeLevel2}",
       "Aggregates": [
        {
          "AggregateCode": "${TierProgression#AggregateCode1}",
          "AggregateDesc": "${TierProgression#AggregateDesc1}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 500,
          "AggregateOperator": "AND"
        },
        {
          "AggregateCode": "${TierProgression#AggregateCode2}",
          "AggregateDesc": "${TierProgression#AggregateDesc2}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 500,
           "AggregateOperator": "OR"
        },
      {
          "AggregateCode": "${TierProgression#AggregateCode3}",
          "AggregateDesc": "${TierProgression#AggregateDesc3}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 10,
          "AggregateOperator": "AND"
        },
        {
          "AggregateCode": "${TierProgression#AggregateCode4}",
          "AggregateDesc": "${TierProgression#AggregateDesc4}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 10,
           "AggregateOperator": "OR"
        },
        {
          "AggregateCode": "HATCHED",
          "AggregateType": "${TierProgression#AggregateType2}",
          "AnnualThreshold": 500
        }
      ]
    },
    {
      "TierCode": "${TierProgression#TierCodeLevel1}",
            "Aggregates": [
        {
          "AggregateCode": "${TierProgression#AggregateCode1}",
          "AggregateDesc": "${TierProgression#AggregateDesc1}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 900,
          "AggregateOperator": "AND"
        },
        {
          "AggregateCode": "${TierProgression#AggregateCode2}",
          "AggregateDesc": "${TierProgression#AggregateDesc2}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold":900,
           "AggregateOperator": "OR"
        },
      {
          "AggregateCode": "${TierProgression#AggregateCode3}",
          "AggregateDesc": "${TierProgression#AggregateDesc3}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 20,
          "AggregateOperator": "AND"
        },
        {
          "AggregateCode": "${TierProgression#AggregateCode4}",
          "AggregateDesc": "${TierProgression#AggregateDesc4}",
          "AggregateType": "${TierProgression#AggregateType1}",
          "AnnualThreshold": 20,
           "AggregateOperator": "OR"
        },
        {
          "AggregateCode": "HATCHED",
          "AggregateType": "${TierProgression#AggregateType2}",
          "AnnualThreshold": 900
        }
      ]
    }
  ]
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/referencedata/programs/tierprogressions</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="febeb414-0bfa-432f-a29a-f0982e368fd0" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="groovy" name="LastYearDate" id="bd006673-5617-4ee2-81f1-f26a4fe4e7bb">
    <con:settings/>
    <con:config>
      <script>import static com.jayway.jsonpath.JsonPath.parse

Calendar cal = Calendar.getInstance();
cal.add(Calendar.YEAR,-1)
def lastYearDate = new java.text.SimpleDateFormat("dd-MMM-yyyy").format(cal.getTime());

return lastYearDate;</script>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="AddTransactionWithLastYearTransactionDate" id="d63b4917-b760-4cff-aee0-cde20816cbd6">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>721c9d8e-bdd9-4288-a701-c671b71b71ef</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>TransactionNumber</con:name>
          <con:value>${=new java.text.SimpleDateFormat("yyyyMMddHHmmssFFFF").format(new Date())}${PurchaseTransaction#TransNumber}</con:value>
        </con:property>
        <con:property>
          <con:name>ProfileId</con:name>
          <con:value>${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}</con:value>
        </con:property>
        <con:property>
          <con:name>TransactionDate</con:name>
          <con:value>${LastYearDate#result}</con:value>
        </con:property>
        <con:property>
          <con:name>RawTransactionId</con:name>
        </con:property>
        <con:property>
          <con:name>TransactionId</con:name>
        </con:property>
        <con:property>
          <con:name>SkipMomentEngine</con:name>
          <con:value>true</con:value>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetProfileTierProgressWithLastYearTransactionDate" id="29022877-d007-4416-a5e6-f90dcd3a9cf3">
    <con:settings/>
    <con:config service="RestAPIs" methodName="GetProfileTierProgress" resourcePath="/api/v1/profiles/{profileId}/dashboard/tiers/progress" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetProfileTierProgressWithLastYearTransactionDate" id="03920aec-12cf-406f-ab1c-39ac05135a02" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/dashboard/tiers/progress</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="7839d857-f89e-487f-bf41-a46b39e8ba10" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Match" id="ea3a027d-90ca-4912-8c65-cb6ad0eda11c" name="Valid Aggregate Total">
          <con:configuration>
            <path>$['ProfileAggregates'][0]['AggregateTotal']</path>
            <content>0.0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="profileId" value="${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}"/>
          <con:entry key="tierProgressionDate" value="${=new java.text.SimpleDateFormat(&quot;yyyy-MM-dd&quot;).format(new Date())}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="AddTransactionWithCurrentYearDate" id="edbe4863-2458-43b5-a22f-1a19dd7c4828">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>721c9d8e-bdd9-4288-a701-c671b71b71ef</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>TransactionNumber</con:name>
          <con:value>${=new java.text.SimpleDateFormat("yyyyMMddHHmmssFFFF").format(new Date())}${PurchaseTransaction#TransNumber}</con:value>
        </con:property>
        <con:property>
          <con:name>ProfileId</con:name>
          <con:value>${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}</con:value>
        </con:property>
        <con:property>
          <con:name>TransactionDate</con:name>
          <con:value>${=new java.text.SimpleDateFormat("dd-MMM-yyyy").format(new Date())}</con:value>
        </con:property>
        <con:property>
          <con:name>RawTransactionId</con:name>
        </con:property>
        <con:property>
          <con:name>TransactionId</con:name>
        </con:property>
        <con:property>
          <con:name>SkipMomentEngine</con:name>
          <con:value>true</con:value>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetTierProgressionWithCurrentYearTransactionDate" id="6828856e-85c3-4784-ba78-a0e77b4d343d">
    <con:settings/>
    <con:config service="RestAPIs" methodName="GetProfileTierProgress" resourcePath="/api/v1/profiles/{profileId}/dashboard/tiers/progress" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetTierProgressionWithCurrentYearTransactionDate" id="b136fecb-090d-450e-b95b-4ef5bc700a0f" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/8c0b8f51-3634-419c-b2d7-d7f43819bbd8/dashboard/tiers/progress</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="4d02a4cf-de1b-4379-aad5-20509e4d4140" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Match" id="9409ad61-93d4-4df7-a91d-ef1bafa906c7" name="Valid Aggregate Total">
          <con:configuration>
            <path>$['ProfileAggregates'][0]['AggregateTotal']</path>
            <content>0.0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="profileId" value="${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}"/>
          <con:entry key="tierProgressionDate" value="${=new java.text.SimpleDateFormat(&quot;yyyy-MM-dd&quot;).format(new Date())}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="AddAdjustment" id="32d197ae-31a9-4c4c-a3cf-6fd1b2e34558">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>d3339fb2-45d2-479b-9947-1ea66f3877fa</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>Points</con:name>
          <con:value>50</con:value>
        </con:property>
        <con:property>
          <con:name>ProfileId</con:name>
          <con:value>${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}</con:value>
        </con:property>
        <con:property>
          <con:name>AdjustmentReason</con:name>
          <con:value>PPGOODW</con:value>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetProfileTierProgressForProfile" id="8b0e0123-73ed-45c0-927f-ea0d0a54918c">
    <con:settings/>
    <con:config service="RestAPIs" methodName="GetProfileTierProgress" resourcePath="/api/v1/profiles/{profileId}/dashboard/tiers/progress" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetProfileTierProgressForProfile" id="be14e729-a70d-4882-babe-5429bc20ab70" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/dashboard/tiers/progress</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="c6aa4266-b5fe-4d63-b522-8541c12e4085" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="JsonPath Match" id="4e0d1cd0-877f-4f8d-8404-ea913fef4fcb" name="Valid Aggregate Total">
          <con:configuration>
            <path>$['ProfileAggregates'][0]['AggregateTotal']</path>
            <content>50.0</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="profileId" value="${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}"/>
          <con:entry key="tierProgressionDate" value="${=new java.text.SimpleDateFormat(&quot;yyyy-MM-dd&quot;).format(new Date())}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
</con:testCase>
