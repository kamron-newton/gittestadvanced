<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="b9031077-17e0-450c-bc83-e08377de17c6" discardOkResults="false" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="ValExpDateProcPrfReward" searchProperties="true" timeout="0" xmlns:con="http://eviware.com/soapui/config">
  <con:settings>
    <con:setting id="b9031077-17e0-450c-bc83-e08377de17c6fileName">ValExpDateProcPrfReward</con:setting>
  </con:settings>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:testStep type="calltestcase" name="AddFlexibleDateRew" id="fa854456-bb18-478e-929a-4da550c6b463">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>0e0d967b-f1f8-4be8-96cb-b0a0f31a6bcb</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>rewardCode</con:name>
          <con:value>REWCERTFLEXDTTYPE</con:value>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="AddProfileRGR" id="45acdf82-ac44-4401-855b-54fa342791d7">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>09d0b29f-fbfa-4136-9573-3b813c1795b3</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>ProfileId</con:name>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="calltestcase" name="AddAdjustment" id="2cf01f04-b778-407f-9653-9d3bf4fd8c48">
    <con:settings/>
    <con:config xsi:type="con:RunTestCaseStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:targetTestCase>d3339fb2-45d2-479b-9947-1ea66f3877fa</con:targetTestCase>
      <con:properties>
        <con:property>
          <con:name>Points</con:name>
          <con:value>5000</con:value>
        </con:property>
        <con:property>
          <con:name>ProfileId</con:name>
          <con:value>${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}</con:value>
        </con:property>
        <con:property>
          <con:name>AdjustmentReason</con:name>
          <con:value>PPGOODW</con:value>
        </con:property>
      </con:properties>
      <con:returnProperties/>
      <con:runMode>SINGLETON_AND_WAIT</con:runMode>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="ProcessProfileRewards" id="c086bbb6-0643-4127-b44e-9c365f8684e4">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/profiles/{profileId}/rewards/catalogs/orders/profilerewards" methodName="ProcessProfileRewards" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="ProcessProfileRewards" id="93f7bcd6-7d24-40b5-bf22-25deb6edcca5" mediaType="application/json" postQueryString="false">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request>{ 
  "EmailAddress": "test@dx2mail.co", 
  "OrderDetails": [
    { 
      "Quantity": 1,
      "RewardCode":"${AddFlexibleDateRew#rewardCode}",
     // "JsonExternalData": "{\"RewardCodeData\":\"ProfileReward\"}"
    }
  ],
  // "JsonExternalData": "{\"RewardCodeData\":\"ProfileReward\"}"
}</con:request>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/030dbbba-0605-4eb7-8ef1-04f39252d4fd/rewards/catalogs/orders/profilerewards</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="f15569bc-aed6-4e90-9040-a77ea05e5bdf" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>201</codes>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="profileId" value="${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}"/>
          <con:entry key="content-type" value="application/json"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="Program-Code" value="${#Project#ProgramCode}"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>profileId</con:entry>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
          <con:entry>content-type</con:entry>
          <con:entry>Program-Code</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:testStep type="restrequest" name="GetProfileRewardCertificates" id="db04798b-36a9-44ce-b938-0c1c104df3b3">
    <con:settings/>
    <con:config service="RestAPIs" resourcePath="/api/v1/profiles/{profileId}/rewards/certificates" methodName="GetProfileRewardCertificates" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:restRequest name="GetProfileRewardCertificates" id="d5988a68-9034-47d0-ae55-7b9dabcbe7cd" mediaType="application/json">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:endpoint>https://d3aldv-pveapi.skynetlowerenv.com/</con:endpoint>
        <con:request/>
        <con:originalUri>https://q3alin-pveapi.skynetlowerenv.com/api/v1/profiles/030dbbba-0605-4eb7-8ef1-04f39252d4fd/rewards/certificates</con:originalUri>
        <con:assertion type="Valid HTTP Status Codes" id="0d9c2503-7df1-4125-990f-5b2ec7b508f1" name="Valid HTTP Status Codes">
          <con:settings/>
          <con:configuration>
            <codes>200</codes>
          </con:configuration>
        </con:assertion>
        <con:assertion type="MessageContentAssertion" id="ed957ac1-d355-45a6-8c00-3464b6c43cac" name="Message Content Assertion">
          <con:configuration xsi:type="con:MessageContentAssertion">
            <con:elements>
              <con:xpath>//Response[1]/e[1]/CertificateNumber[1]</con:xpath>
              <con:element>CertificateNumber</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>155f1cf2-5b2e-47dd-8e15-277e1e3b2624</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/ProfileId[1]</con:xpath>
              <con:element>ProfileId</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>3115529c-626c-432b-bafd-e74b0b1a3d45</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/PriceInPoints[1]</con:xpath>
              <con:element>PriceInPoints</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>15</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/OrderId[1]</con:xpath>
              <con:element>OrderId</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>b8d8f7e3-e8c5-4d0b-8314-2c9136cbbf98</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/RetailValue[1]</con:xpath>
              <con:element>RetailValue</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>1.0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/ExpirationDate[1]</con:xpath>
              <con:element>ExpirationDate</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>true</con:enabled>
              <con:expectedValue>2021-12-12T23:59:59.999Z</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/ProgramCode[1]</con:xpath>
              <con:element>ProgramCode</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>PP</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/RewardCode[1]</con:xpath>
              <con:element>RewardCode</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>REWCERTFLEXDTTYPE</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/Title[1]</con:xpath>
              <con:element>Title</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>Test Movie  PP</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/StartDate[1]</con:xpath>
              <con:element>StartDate</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>2019-01-01T00:00:00Z</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/EndDate[1]</con:xpath>
              <con:element>EndDate</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>2025-01-01T00:00:00Z</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/ProgramCost[1]</con:xpath>
              <con:element>ProgramCost</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>1.0</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/Status[1]</con:xpath>
              <con:element>Status</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>A</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/AccountSourceCode[1]</con:xpath>
              <con:element>AccountSourceCode</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>ALMACCT</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/SourceAccountNumber[1]</con:xpath>
              <con:element>SourceAccountNumber</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>3115529c-626c-432b-bafd-e74b0b1a3d45</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/BrandOrgCode[1]</con:xpath>
              <con:element>BrandOrgCode</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>ALM_BRAND</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/ActivityDate[1]</con:xpath>
              <con:element>ActivityDate</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>2021-12-01T06:11:01Z</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/PointTypeShortDescription[1]</con:xpath>
              <con:element>PointTypeShortDescription</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>Eggs</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/EffectiveDate[1]</con:xpath>
              <con:element>EffectiveDate</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>2021-12-07T00:00:00Z</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/CertificateStatusDesc[1]</con:xpath>
              <con:element>CertificateStatusDesc</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>Active</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/RewardId[1]</con:xpath>
              <con:element>RewardId</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>bab448b8-299a-4611-a967-2541dbeba4b4</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/RewardType[1]</con:xpath>
              <con:element>RewardType</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>O</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/CreateUser[1]</con:xpath>
              <con:element>CreateUser</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>AUTO_USER</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/CreateDate[1]</con:xpath>
              <con:element>CreateDate</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>2021-12-01T06:11:01.785869Z</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/UpdateUser[1]</con:xpath>
              <con:element>UpdateUser</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>AUTO_USER</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:elements>
              <con:xpath>//Response[1]/e[1]/UpdateDate[1]</con:xpath>
              <con:element>UpdateDate</con:element>
              <con:type xsi:nil="true"/>
              <con:operator>=</con:operator>
              <con:enabled>false</con:enabled>
              <con:expectedValue>2021-12-01T06:11:01.785869Z</con:expectedValue>
              <con:hasValue>false</con:hasValue>
              <con:numberType>false</con:numberType>
            </con:elements>
            <con:originalMessage><![CDATA[<Response>
   <e>
      <CertificateNumber>155f1cf2-5b2e-47dd-8e15-277e1e3b2624</CertificateNumber>
      <ProfileId>3115529c-626c-432b-bafd-e74b0b1a3d45</ProfileId>
      <PriceInPoints>15</PriceInPoints>
      <OrderId>b8d8f7e3-e8c5-4d0b-8314-2c9136cbbf98</OrderId>
      <RetailValue>1.0</RetailValue>
      <ExpirationDate>2021-12-12T23:59:59.999Z</ExpirationDate>
      <ProgramCode>PP</ProgramCode>
      <RewardCode>REWCERTFLEXDTTYPE</RewardCode>
      <Title>Test Movie  PP</Title>
      <StartDate>2019-01-01T00:00:00Z</StartDate>
      <EndDate>2025-01-01T00:00:00Z</EndDate>
      <ProgramCost>1.0</ProgramCost>
      <Status>A</Status>
      <AccountSourceCode>ALMACCT</AccountSourceCode>
      <SourceAccountNumber>3115529c-626c-432b-bafd-e74b0b1a3d45</SourceAccountNumber>
      <BrandOrgCode>ALM_BRAND</BrandOrgCode>
      <ActivityDate>2021-12-01T06:11:01Z</ActivityDate>
      <PointTypeShortDescription>Eggs</PointTypeShortDescription>
      <EffectiveDate>2021-12-07T00:00:00Z</EffectiveDate>
      <CertificateStatusDesc>Active</CertificateStatusDesc>
      <RewardId>bab448b8-299a-4611-a967-2541dbeba4b4</RewardId>
      <RewardType>O</RewardType>
      <CreateUser>AUTO_USER</CreateUser>
      <CreateDate>2021-12-01T06:11:01.785869Z</CreateDate>
      <UpdateUser>AUTO_USER</UpdateUser>
      <UpdateDate>2021-12-01T06:11:01.785869Z</UpdateDate>
   </e>
</Response>]]></con:originalMessage>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:parameters>
          <con:entry key="Authorization" value="OAuth ${#Project#AuthToken}"/>
          <con:entry key="profileId" value="${#[Profile#AddProfileRGR#AddProfileRGR]#Response#$['ProfileId']}"/>
          <con:entry key="rewardCode" value="${AddFlexibleDateRew#rewardCode}"/>
          <con:entry key="Accept-Language" value="en-US"/>
          <con:entry key="status" value="A"/>
        </con:parameters>
        <con:parameterOrder>
          <con:entry>profileId</con:entry>
          <con:entry>status</con:entry>
          <con:entry>rewardCode</con:entry>
          <con:entry>title</con:entry>
          <con:entry>startDate</con:entry>
          <con:entry>endDate</con:entry>
          <con:entry>Accept-Language</con:entry>
          <con:entry>Authorization</con:entry>
        </con:parameterOrder>
        <con:environmentSpec>
          <con:entry environmentId="3c955a23-3567-47af-b6e9-aacfcca8d9aa">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
          <con:entry environmentId="47bb433b-fb70-41f0-b289-86004efd1deb">
            <con:authProfile>Inherit From Parent</con:authProfile>
          </con:entry>
        </con:environmentSpec>
      </con:restRequest>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
</con:testCase>
